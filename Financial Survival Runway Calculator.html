<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Financial Survival Runway Calculator</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
<!--body{font-family:Arial;background:#f4f6f9;padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:25px;border-radius:10px}
h2,h3{text-align:center}
.section{margin-top:30px}
.grid{display:grid;grid-template-columns:1fr 140px;gap:10px}
input{padding:6px}
.total{background:#eef1f6;font-weight:bold}
button{padding:12px;border:none;border-radius:6px;cursor:pointer;margin-top:10px;align="right"}
.calc{background:#007bff;color:#fff;width:100%}
.reset{background:#6c757d;color:#fff;width:20%;margin-top:20px}  
.pdf{background:#28a745;color:#fff;width:100%}
.logout{background:#dc3545;color:#fff;width:100%}
.result{margin-top:30px;padding:20px;border-radius:10px;text-align:center}
.warning{color:red;text-align:center;margin-top:10px}
canvas{max-width:400px;margin:auto}
#dashboard{display:none}
#loginBox{max-width:400px;margin:auto;margin-top:120px}-->

body{font-family:Arial;background:#f2f4f8;margin:0;padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:25px;border-radius:10px}
.title{color:#0d6efd;text-align:center;font-size:28px;margin-bottom:10px}
.top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.top-buttons button{margin-left:6px}
button{padding:10px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:bold}
.btn-calc{background:#0d6efd;color:#fff;width:100%;margin-top:20px}
.btn-reset{background:#6c757d;color:#fff}
.section{margin-top:25px}
.section h3{color:#0d6efd;border-bottom:2px solid #e1e5ea;padding-bottom:4px}
.grid{display:grid;grid-template-columns:1fr 160px;gap:10px;margin-top:10px}
input{padding:7px}
.total{background:#eef2f7;font-weight:bold}
.warning{color:red;text-align:center;margin-top:10px}
.result{background:#f8f9fa;padding:20px;border-radius:10px;margin-top:20px}
canvas{max-width:450px;margin:auto}
#dashboard{display:none}
#login{max-width:400px;margin:auto;margin-top:120px}

</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="container">
<h2>Login</h2>
<input id="uid" placeholder="User ID"><br><br>
<input id="pwd" type="password" placeholder="Password"><br><br>
<button class="calc" onclick="login()">Login</button>
<p id="err" class="warning"></p>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="container">

<!--<h2>Financial Survival Runway Calculator</h2>
<button class="reset" onclick="resetTotals()">Reset</button>-->

<div class="top-bar">
<h2 class="title">Financial Survival Runway Calculator</h2>
<div class="top-buttons">
<button class="btn-reset" onclick="resetTotals()">Reset</button>
</div>
</div>

<!-- PERSONAL INFO -->
<div class="section">
<h3>Personal Information</h3>
<div class="grid">
<label>Name</label><input id="pname">
<label>Contact Number</label><input id="pcontact">
<label>Email ID</label><input id="pemail">
</div>
<p id="validationMsg" class="warning"></p>
</div>

<!-- LIQUID SAVINGS -->
<div class="section">
<h3>Liquid Savings</h3>
<div class="grid">
<label>Savings Bank</label><input id="s1">
<label>Fixed Deposits</label><input id="s2">
<label>Liquid Mutual Funds</label><input id="s3">
<label>Cash in Hand</label><input id="s4">
<label>Emergency Fund</label><input id="s5">
<label class="total">Total Liquid Savings</label><input id="totalSavings" class="total" readonly>
</div>
</div>

<!-- INCOME -->
<div class="section">
<h3>Monthly Income</h3>
<div class="grid">
<label>Salary</label><input id="i1">
<label>Spouse Contribution</label><input id="i2">
<label>Rental Income</label><input id="i3">
<label>Freelance</label><input id="i4">
<label>Interest</label><input id="i5">
<label class="total">Total Monthly Income</label><input id="totalIncome" class="total" readonly>
</div>
</div>

<!-- FIXED -->
<div class="section">
<h3>Fixed Expenses</h3>
<div class="grid">
<label>Rent / EMI</label><input id="f1">
<label>Electricity</label><input id="f2">
<label>Water / Gas</label><input id="f3">
<label>Internet</label><input id="f4">
<label>Mobile</label><input id="f5">
<label>Insurance</label><input id="f6">
<label>School Fees</label><input id="f7">
<label>Vehicle EMI</label><input id="f8">
<label>Maintenance</label><input id="f9">
<label>Domestic Help</label><input id="f10">
<label class="total">Total Fixed Expenses</label><input id="totalFixed" class="total" readonly>
</div>
</div>

<!-- VARIABLE -->
<div class="section">
<h3>Variable Expenses</h3>
<div class="grid">
<label>Groceries</label><input id="v1">
<label>Eating Out</label><input id="v2">
<label>Transport</label><input id="v3">
<label>Shopping</label><input id="v4">
<label>Entertainment</label><input id="v5">
<label>Medical</label><input id="v6">
<label>Travel</label><input id="v7">
<label>Misc</label><input id="v8">
<label class="total">Total Variable Expenses</label><input id="totalVariable" class="total" readonly>
</div>
</div>

<!-- SUPPORT -->
<div class="section">
<h3>Support Income</h3>
<div class="grid">
<label>Spouse Income</label><input id="sp1">
<label>Rental Income</label><input id="sp2">
<label>Passive Income</label><input id="sp3">
<label>Family Support</label><input id="sp4">
<label class="total">Total Support Income</label><input id="totalSupport" class="total" readonly>
</div>
</div>

<button class="calc" onclick="calculate()">Calculate</button>

<!--<button class="pdf" onclick="exportPDF()">Export PDF</button>
<button class="logout" onclick="logout()">Logout</button> -->

<div id="output" class="result"></div>
<canvas id="expenseChart"></canvas>

</div>

<script>
const users=[
 {username:"admin",password:"1234"},
 {username:"user1",password:"abcd"}
];
let currentUser=null,chart=null;

function login(){
 const u=uid.value,p=pwd.value;
 if(users.find(x=>x.username===u&&x.password===p)){
  currentUser=u;
  loginBox.style.display="none";
  dashboard.style.display="block";
 } else err.innerText="Invalid credentials";
}

function logout(){location.reload();}

function validatePersonal(){
 const phone=/^[0-9]{10}$/;
 const email=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;
 if(!phone.test(pcontact.value)){
  validationMsg.innerText="Invalid contact number (10 digits required)";
  return false;
 }
 if(!email.test(pemail.value)){
  validationMsg.innerText="Invalid email address";
  return false;
 }
 validationMsg.innerText="";
 return true;
}

function sum(ids){
 return ids.reduce((t,id)=>t+(+document.getElementById(id).value||0),0);
}
function inr(x){return "â‚¹ "+x.toLocaleString("en-IN");}

function calculate(){
 if(!validatePersonal()) return;

 let savings=sum(["s1","s2","s3","s4","s5"]);
 let income=sum(["i1","i2","i3","i4","i5"]);
 let fixed=sum(["f1","f2","f3","f4","f5","f6","f7","f8","f9","f10"]);
 let variable=sum(["v1","v2","v3","v4","v5","v6","v7","v8"]);
 let support=sum(["sp1","sp2","sp3","sp4"]);

 totalSavings.value=inr(savings);
 totalIncome.value=inr(income);
 totalFixed.value=inr(fixed);
 totalVariable.value=inr(variable);
 totalSupport.value=inr(support);

 let expenses=fixed+variable;
 let net=Math.max(expenses-support,0);
 let months=(savings+income)/net;

 let status="Strong",bg="#d4edda";
 if(months<3){status="Critical";bg="#f8d7da";}
 else if(months<6){status="Moderate";bg="#fff3cd";}
 else if(months<12){status="Stable";bg="#d1ecf1";}

 output.style.background=bg;
 output.innerHTML=`
 <h2>${months.toFixed(1)} Months</h2>
 <p>Status: <b>${status}</b></p>
 <p>Total Expenses: ${inr(expenses)}</p>
 <p>Net Monthly Requirement: ${inr(net)}</p>
 `;

 if(chart) chart.destroy();
 chart=new Chart(expenseChart,{
  type:"pie",
  data:{labels:["Fixed","Variable"],datasets:[{data:[fixed,variable]}]}
 });
 
 if(runChart) runChart.destroy();
 runChart=new Chart(runwayChart,{
  type:"bar",
  data:{labels:["Savings","Monthly Need"],datasets:[{data:[savings,income]}]}
 });
}

function resetTotals(){
 document.querySelectorAll(".total").forEach(i=>i.value="");
 output.innerHTML="";
 if(chart) chart.destroy();
}

function exportPDF(){
 if(!validatePersonal()) return;
 html2pdf().from(dashboard).save("Financial_Runway_Report.pdf");
}
</script>

</body>
</html>
